name: Test Engine Uploader
description: Uploads JUnit test results to Buildkite Test Engine with optional redaction of sensitive data
author: https://github.com/snowflakedb
requirements:
  - curl
  - python3

configuration:
  properties:
    file_pattern:
      type: string
      description: Glob pattern to match JUnit XML files (e.g., "bazel-testlogs/**/*.xml")
    redact:
      type: boolean
      description: Whether to redact all sensitive data in the XML files (default: false)
      default: false
    analytics_token_env:
      type: string
      description: Environment variable name containing the Buildkite Analytics token (default: "BUILDKITE_ANALYTICS_TOKEN")
      default: "BUILDKITE_ANALYTICS_TOKEN"
    upload_timeout:
      type: integer
      description: Timeout in seconds for each file upload (default: 10)
      default: 30
    max_file_size:
      type: integer
      description: Maximum file size in MB to upload (default: 100)
      default: 10
    upload_parallelism:
      type: integer
      description: Number of parallel upload jobs (default: 5)
      default: 5
  required:
    - file_pattern
  additionalProperties: false
